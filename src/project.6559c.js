window.__require=function e(t,n,a){function r(i,o){if(!n[i]){if(!t[i]){var s=i.split("/");if(s=s[s.length-1],!t[s]){var d="function"==typeof __require&&__require;if(!o&&d)return d(s,!0);if(c)return c(s,!0);throw new Error("Cannot find module '"+i+"'")}i=s}var h=n[i]={exports:{}};t[i][0].call(h.exports,function(e){return r(t[i][1][e]||e)},h,h.exports,e,t,n,a)}return n[i].exports}for(var c="function"==typeof __require&&__require,i=0;i<a.length;i++)r(a[i]);return r}({card:[function(e,t,n){"use strict";cc._RF.push(t,"367abP9/XFDPbjT8YYMAJVW","card"),cc.Class({extends:cc.Component,properties:{backCard:{default:null,type:cc.Sprite},backCheck:null,setRotateOffset:null},onLoad:function(){this.backCheck=this._backCheck.bind(this),this.setRotateOffset=this._setRotateOffset.bind(this)},_setRotateOffset:function(e,t,n,a){var r=(this.node.eulerAngles.x+e)%360,c=(this.node.eulerAngles.y+t)%360,i=(this.node.angle+n)%360;this.node.eulerAngles=cc.v3(r,c,i);var o=Math.atan2(a-this.node.z,this.node.y)/Math.PI*180-90,s=0;s+=r>=o-90&&r<=o+90?1:0;var d=Math.atan2(a-this.node.z,this.node.x)/Math.PI*180-90;s+=c>=d-90&&c<=d+90?1:0,this.backCard.enabled=1==s},_backCheck:function(e){var t=this.node.eulerAngles.x,n=this.node.eulerAngles.y,a=0,r=Math.atan2(e-this.node.z,this.node.y)/Math.PI*180-90,c=Math.atan2(e-this.node.z,this.node.x)/Math.PI*180-90;a+=t>=r-90&&t<=r+90?1:0,a+=n>=c-90&&n<=c+90?1:0,this.backCard.enabled=1==a}}),cc._RF.pop()},{}],game:[function(e,t,n){"use strict";cc._RF.push(t,"72d9fKPVdpHerKSe9L1eYJk","game");var a=new Array,r=new Array,c={},i=!1,o=["c01","c02","c03","c04","c05","c06","c07","c08","c09","c10","c11","c12","c13","d01","d02","d03","d04","d05","d06","d07","d08","d09","d10","d11","d12","d13","h01","h02","h03","h04","h05","h06","h07","h08","h09","h10","h11","h12","h13","s01","s02","s03","s04","s05","s06","s07","s08","s09","s10","s11","s12","s13"];cc.Class({extends:cc.Component,properties:{tmpCard:{default:null,type:cc.Prefab},Cards:{default:null,type:cc.Node},framecount:0},setSpriteFrame_cNode:function(e,t,n){this.setSpriteFrameComp(e,n.getChildByName(t))},setSpriteFrameComp:function(e,t){null==t&&cc.error("component is null.");var n=t.getComponent(cc.Sprite);null==n?cc.error("not sprite component."):this.setSpriteFrame(e,n)},setSpriteFrame:function(e,t){var n="img/"+e;cc.loader.loadRes(n,cc.SpriteFrame,function(e,n){e?cc.error(e.message||e):t.spriteFrame=n})},cardshaffle:function(){a=new Array,r=new Array,c={},i=!1;for(var e=o;e.length;){var t=Math.floor(Math.random()*e.length);a.push(e[t]),e.splice(t,1)}},onLoad:function(){this.cardshaffle();var e=cc.instantiate(this.tmpCard);this.setSpriteFrameComp(a.pop(),e),e.setPosition(cc.v2(0,150)),this.Cards.addChild(e,0,"master");for(var t=1;t<6;t++)(e=new cc.instantiate(this.tmpCard)).setPosition(this.getNewStarPosition(t-1)),this.setSpriteFrameComp(a.pop(),e),e.name="card"+t,c[e.name]=e,e.on(cc.Node.EventType.TOUCH_START,this.cardTouchevent,this),this.Cards.addChild(e);for(;t<52;t++){var n;(e=new cc.instantiate(this.tmpCard)).setPosition(cc.v3(-350,150,t)),this.setSpriteFrameComp(a.pop(),e),e.name="card"+t,r.push(e.name),this.Cards.addChild(e,t,e.name),null===(n=this.getCardObj(e.name))||void 0===n||n.setRotateOffset(180,0,0,556)}e.on(cc.Node.EventType.TOUCH_START,this.pullcardTouchEvent,this)},getNewStarPosition:function(e){var t=e%this.node.width*this.tmpCard.data.width-this.node.width/2+180;return cc.v3(t,-150,0)},masterCardDelete:function(e){var t=e.getChildByName("master"),n=e.getChildByName("endmaster");null!=n&&(t.x=n.x,t.y=n.y,n.destroy()),t.zIndex=0,t.name="endmaster"},pullcardTouchEvent:function(e){if(!i){var t=e.target.parent.getChildByName("master"),n=(e.target.getComponent(cc.Sprite).spriteFrame.name,t.getComponent(cc.Sprite).spriteFrame.name);for(var a in c)if(this.checkCards(n,c[a].getComponent(cc.Sprite).spriteFrame.name))return;if(i=!0,this.masterCardDelete(e.target.parent),r.length)if(r.pop(),r.length)e.target.parent.getChildByName(r[r.length-1]).on(cc.Node.EventType.TOUCH_START,this.pullcardTouchEvent,this);this.cardmoveCommonfunc(e.target,cc.v3(0,-180,0),cc.v3(t.x,t.y,0),cc.callFunc(function(){i=!1,e.target.zIndex=0},e.target)),e.target.name="master"}},cardmoveCommonfunc:function(e,t,n,a){e.off(cc.Node.EventType.TOUCH_START),e.eulerAngles=t,e.runAction(cc.rotate3DTo(.5,0,0,0).easing(cc.easeCubicActionOut())),e.runAction(cc.sequence(cc.moveTo(.5,n).easing(cc.easeExponentialOut()),a))},cardTouchevent:function(e){if(!i){var t=e.target.parent.getChildByName("master"),n=e.target.getComponent(cc.Sprite).spriteFrame.name,a=t.getComponent(cc.Sprite).spriteFrame.name;if(this.checkCards(n,a)){if(i=!0,this.masterCardDelete(e.target.parent),r.length){var o=e.target.parent.getChildByName(r.pop());if(this.cardmoveCommonfunc(o,cc.v3(-180,0,0),cc.v3(e.target.x,e.target.y,0),cc.callFunc(function(){o.zIndex=0},o)),c[o.name]=o,o.on(cc.Node.EventType.TOUCH_START,this.cardTouchevent,this),r.length)e.target.parent.getChildByName(r[r.length-1]).on(cc.Node.EventType.TOUCH_START,this.pullcardTouchEvent,this)}delete c[e.target.name],e.target.zIndex=1,this.cardmoveCommonfunc(e.target,cc.v3(0,0,0),cc.v3(t.x,t.y,0),cc.callFunc(function(){i=!1,e.target.zIndex=0},e.target)),e.target.name="master"}}},checkCards:function(e,t){var n=/^([a-z])0*([0-9]{1,2})/.exec(e),a=/^([a-z])0*([0-9]{1,2})/.exec(t);return n[1]==a[1]||n[2]==a[2]},getCardObj:function(e){var t;return null===(t=this.Cards.getChildByName(e))||void 0===t?void 0:t.getComponent("card")},getSpriteFrame:function(e){var t;return null===(t=this.Cards.getChildByName(e))||void 0===t?void 0:t.getComponent(cc.Sprite)},testPos:function(e,t){var n=t;e.x=-350,e.y=150,e.z=n},update:function(e){this.Cards.children.forEach(function(e){e.getComponent("card").backCheck(555)})}}),cc._RF.pop()},{}],imageLoad:[function(e,t,n){"use strict";cc._RF.push(t,"0df26hx9E1HjrRRZVvo9j44","imageLoad"),cc.Class({extends:cc.Component,properties:{imageData:null},onLoad:function(){this._loadImages()},_loadImages:function(){var e=this;cc.loader.loadResDir("png",cc.SpriteFrame,function(t,n){t?cc.error(t):e.imageData=n})}}),cc._RF.pop()},{}]},{},["card","game","imageLoad"]);