window.__require=function e(t,c,a){function n(s,o){if(!c[s]){if(!t[s]){var i=s.split("/");if(i=i[i.length-1],!t[i]){var h="function"==typeof __require&&__require;if(!o&&h)return h(i,!0);if(r)return r(i,!0);throw new Error("Cannot find module '"+s+"'")}s=i}var d=c[s]={exports:{}};t[s][0].call(d.exports,function(e){return n(t[s][1][e]||e)},d,d.exports,e,t,c,a)}return c[s].exports}for(var r="function"==typeof __require&&__require,s=0;s<a.length;s++)n(a[s]);return n}({card:[function(e,t,c){"use strict";cc._RF.push(t,"367abP9/XFDPbjT8YYMAJVW","card"),cc.Class({extends:cc.Component,properties:{backCard:{default:null,type:cc.Sprite},backCheck:null,setRotateOffset:null},onLoad:function(){this.backCheck=this._backCheck.bind(this),this.setRotateOffset=this._setRotateOffset.bind(this)},_setRotateOffset:function(e,t,c,a){var n=(this.node.eulerAngles.x+e)%360,r=(this.node.eulerAngles.y+t)%360,s=(this.node.angle+c)%360;this.node.eulerAngles=cc.v3(n,r,s);var o=Math.atan2(a-this.node.z,this.node.y)/Math.PI*180-90,i=0;i+=n>=o-90&&n<=o+90?1:0;var h=Math.atan2(a-this.node.z,this.node.x)/Math.PI*180-90;i+=r>=h-90&&r<=h+90?1:0,this.backCard.enabled=1==i},_backCheck:function(e){var t=[0,this.node.eulerAngles.x,this.node.eulerAngles.y],c=t[0],a=t[1],n=t[2],r=Math.atan2(e-this.node.z,this.node.y)/Math.PI*180-90,s=Math.atan2(e-this.node.z,this.node.x)/Math.PI*180-90;c+=a>=r-90&&a<=r+90?1:0,c+=n>=s-90&&n<=s+90?1:0,this.backCard.enabled=1==c}}),cc._RF.pop()},{}],game:[function(e,t,c){"use strict";cc._RF.push(t,"72d9fKPVdpHerKSe9L1eYJk","game");var a={stack:[],disp:{},masterPos:{x:0,y:0}},n=["c01","c02","c03","c04","c05","c06","c07","c08","c09","c10","c11","c12","c13","d01","d02","d03","d04","d05","d06","d07","d08","d09","d10","d11","d12","d13","h01","h02","h03","h04","h05","h06","h07","h08","h09","h10","h11","h12","h13","s01","s02","s03","s04","s05","s06","s07","s08","s09","s10","s11","s12","s13"];cc.Class({extends:cc.Component,properties:{tmpCard:{default:null,type:cc.Prefab},Cards:{default:null,type:cc.Node}},setSpriteFrameComp:function(e,t){null==t&&cc.error("component is null.");var c=t.getComponent(cc.Sprite);null==c?cc.error("not sprite component."):this.setSpriteFrame(e,c)},setSpriteFrame:function(e,t){var c="img/"+e;cc.loader.loadRes(c,cc.SpriteFrame,function(e,c){e?cc.error(e.message||e):t.spriteFrame=c})},cardshaffle:function(){a={stack:new Array,disp:{},masterPos:{x:0,y:150}};for(var e=[0,n.slice()],t=e[0],c=e[1];c.length;){var r=["card"+t,Math.floor(Math.random()*c.length),cc.instantiate(this.tmpCard)],s=r[0],o=r[1],i=r[2];i.setPosition(cc.v3(-350,150,t)),this.setSpriteFrameComp(c[o],i),i.eulerAngles=cc.v3(180,0,0),i.touch=!1,a.stack.push(s),this.Cards.addChild(i,t,s),c.splice(o,1),t++}for(var h,d=function(e,t,c,a,n){e.touch=!0,e.eulerAngles=a,e.runAction(cc.sequence(cc.delayTime(t),cc.spawn(cc.moveTo(c,n).easing(cc.easeExponentialOut()),cc.rotate3DTo(c,0,0,0).easing(cc.easeCubicActionOut())),cc.callFunc(function(){this.zIndex=0,this.touch=!1},e)))},u=0;u<5;u++)h=this.Cards.getChildByName(a.stack.pop()),a.disp[h.name]=h,d(h,.2*u,1,cc.v3(0,180,0),this.getNewStarPosition(4-u)),h.on(cc.Node.EventType.TOUCH_START,this.cardTouchevent,this);(h=this.Cards.getChildByName(a.stack.pop())).name="master",d(h,1,1,cc.v3(0,180,0),cc.v3(a.masterPos.x,a.masterPos.y,0)),this.Cards.getChildByName(a.stack[a.stack.length-1]).on(cc.Node.EventType.TOUCH_START,this.pullcardTouchEvent,this)},onLoad:function(){this.cardshaffle(),this.node.getChildByName("RePlayButton").on(cc.Node.EventType.TOUCH_START,function(){this.Cards.removeAllChildren(),this.cardshaffle()},this)},getNewStarPosition:function(e){var t=e%this.node.width*this.tmpCard.data.width-this.node.width/2+180;return cc.v3(t,-150,0)},masterCardDelete:function(e){var t=e.getChildByName("master");t.zIndex=0,t.name="endmaster"},cardmoveCommonfunc:function(e,t,c,a){e.off(cc.Node.EventType.TOUCH_START),e.touch=!0,e.eulerAngles=t,e.runAction(cc.sequence(cc.spawn(cc.moveTo(.5,c).easing(cc.easeExponentialOut()),cc.rotate3DTo(.5,0,0,0).easing(cc.easeCubicActionOut())),cc.callFunc(a,e)))},pullcardTouchEvent:function(e){if(!e.target.touch){var t=e.target.parent.getChildByName("master").getComponent(cc.Sprite).spriteFrame.name;for(var c in a.disp)if(this.checkCards(t,a.disp[c].getComponent(cc.Sprite).spriteFrame.name))return;this.masterCardDelete(e.target.parent),a.stack.pop(),a.stack.length&&e.target.parent.getChildByName(a.stack[a.stack.length-1]).on(cc.Node.EventType.TOUCH_START,this.pullcardTouchEvent,this),this.cardmoveCommonfunc(e.target,cc.v3(0,-180,0),cc.v3(a.masterPos.x,a.masterPos.y,0),function(){this.zIndex=0,this.touch=!1}),e.target.name="master"}},cardTouchevent:function(e){if(!e.target.touch){var t=e.target.parent.getChildByName("master"),c=e.target.getComponent(cc.Sprite).spriteFrame.name,n=t.getComponent(cc.Sprite).spriteFrame.name;if(!this.checkCards(c,n))return e.target.touch=!0,void e.target.runAction(cc.sequence(cc.moveTo(.25,cc.v3(e.target.x,e.target.y+25,0)).easing(cc.easeExponentialOut()),cc.moveTo(.25,cc.v3(e.target.x,e.target.y,0)).easing(cc.easeExponentialIn()),cc.callFunc(function(){this.touch=!1},e.target)));if(this.masterCardDelete(e.target.parent),a.stack.length){var r=e.target.parent.getChildByName(a.stack.pop());this.cardmoveCommonfunc(r,cc.v3(-180,0,0),cc.v3(e.target.x,e.target.y,0),function(){this.zIndex=0,this.touch=!1}),a.disp[r.name]=r,r.on(cc.Node.EventType.TOUCH_START,this.cardTouchevent,this),a.stack.length&&e.target.parent.getChildByName(a.stack[a.stack.length-1]).on(cc.Node.EventType.TOUCH_START,this.pullcardTouchEvent,this)}delete a.disp[e.target.name],e.target.zIndex=1,this.cardmoveCommonfunc(e.target,cc.v3(0,0,0),cc.v3(a.masterPos.x,a.masterPos.y,0),function(){this.zIndex=0,this.touch=!1}),e.target.name="master"}},checkCards:function(e,t){var c=[/^([a-z])0*([0-9]{1,2})/.exec(e),/^([a-z])0*([0-9]{1,2})/.exec(t)],a=c[0],n=c[1];return a[1]==n[1]||a[2]==n[2]},update:function(e){this.Cards.children.forEach(function(e){e.getComponent("card").backCheck(555)})}}),cc._RF.pop()},{}],imageLoad:[function(e,t,c){"use strict";cc._RF.push(t,"0df26hx9E1HjrRRZVvo9j44","imageLoad"),cc.Class({extends:cc.Component,properties:{imageData:null},onLoad:function(){this._loadImages()},_loadImages:function(){var e=this;cc.loader.loadResDir("png",cc.SpriteFrame,function(t,c){t?cc.error(t):e.imageData=c})}}),cc._RF.pop()},{}]},{},["card","game","imageLoad"]);